Select item_id
From item
Where prod_code in(
--books
3, 50, 51, 53, 54, 55, 56, 58, 59, 60, 
61, 62, 63, 94, 95, 96, 97, 100, 150, 
151, 153, 155, 159, 166, 167, 302, 303, 
385, 386, 417, 418, 419, 421, 422, 441,
442, 443, 455, 464, 651, 653, 655, 659,
--music
1, 2, 4, 5, 6, 8, 9, 10, 11, 12, 13,
14, 22, 36, 41, 42, 44, 45, 91, 107,
158, 161, 162, 163, 340, 341, 342, 343,
371, 373, 378, 379, 405, 458, 483, 482,
--movies
34, 37, 39, 92, 93, 144, 156, 309, 310,
311, 315, 316, 321, 322, 344, 345, 346,
347, 348, 349, 350, 351, 352, 353, 354,
355, 356, 456, 457, 470, 476, 637, 3125,
--games
7, 30, 40, 43, 49, 130, 131, 152, 154,
157, 301, 304, 305, 306, 307, 313, 314,
331, 332, 333, 334, 335, 372, 388, 406,
407, 444, 445, 446, 447, 448, 449, 450,
451, 452, 453, 459, 460, 461, 462, 463,
464, 465, 466, 467, 468, 469, 979, 981,
984, 985, 986)
And item_status_id in("P")
into temp t_items
with no log;

select t.item_id
from no_reord_period n, t_items t
where edate >= today+10
and n.item_id = t.item_id
into temp t_noupdates
with no log;

delete from t_items
where item_id in (select item_id from t_noupdates);

delete from t_items
where item_id in (40213566249, 40215416053, 40046635283, 40219593624, 
40046087201, 40219593683, 40217905479, 40212181779, 40216715912, 
79404354662, 40216186620, 40219178786, 40214287307, 40210430230, 
40220077784, 40213693541, 40219017450, 40210823655, 40212101397, 
40210898482, 40215456626, 40219593618, 40213713998, 40219371501, 
40213907584, 40219017451, 40215396226, 40219593777, 40219590639, 
40219273571, 40216175465, 40214287304, 8539228262, 40213936805, 
40049755870, 40219590642, 40213659342, 40046009790, 40210272302, 
40213566244, 40213545942, 40219593608, 40219593684, 40046078438, 
40219089291, 40219921983, 40219593638, 40219593702, 40238005750, 
40237145269, 40246861263, 40219606585, 40213566231, 40216307068, 
40219593639, 40219593654, 40219593613, 40215460026, 40211431088, 
40219593660, 40219593634, 40219593685, 40216309027, 40219593699, 
40219626210, 40235847676, 40237222064, 40238005748, 40217875676, 
40219626255, 40212479073, 40232245183, 40216307064, 40238005752, 
40210649356, 40220027344, 40213936804, 40237142764, 40237145268, 
40045283650, 40255086723, 40238131267, 40219606617, 40220130345, 
40255433334, 40212479087, 40211164774, 40215369206, 40210594687, 
40211375642, 40219590680, 40049755897, 40210736516, 40216398145, 
40217591062, 40217591061, 40217591060, 40217591059, 40210568665, 
40219593686, 40219593687, 40213566292, 1476418642, 40210568666, 
40213617137, 40047224954, 40213566293, 40233829268, 40210718187, 
40218726374, 40217611684, 40217611683, 40233829269, 40235855016, 
40233829250, 40233829271, 40235855017, 40219289645, 40211995059, 
40219590679, 40211125468, 40232307568, 40237103910, 40219289646, 
40219893238, 40219697574, 40235855002, 40238005708, 40233829270, 
40219697572, 40218726375, 40218726376, 40220109023, 40232231326, 
1476420622, 40211038795, 40233829251, 40219893239, 40218726378, 
40233829273, 40210878197, 40237142765, 40220063250, 40219273583, 
40232245181, 40220027349, 40212568349, 40211438637, 40214110483, 
40219593558, 40219593452, 40213545925, 40211759813, 40211430361, 
40219593517, 40217932348, 40212973457, 40219593472, 40219593521, 
40219593523, 40219593450, 40219593451, 40219901895, 40219593462, 
40216483056, 40212163564, 40219593491, 40215456625, 40219593567, 
40219757025, 40219593518, 40268396820, 40268396815, 40212087298, 
40218705228, 40213116038, 40219922018, 40212241042, 40219593483, 
40268396816, 40219593481, 40216714027, 40219593602, 40219593504, 
40219593502, 40219017465, 40268396818, 40219593508, 40213713999, 
40214335922, 40215416052, 40213659343, 40217905521, 40215396225, 
40214132945, 40211160287, 40216534972, 40218016058, 40219813711, 
40217625012, 40212479090, 40219593464, 40219102557, 40211125835, 
40211565766, 40215356253, 40220062353, 40219273585, 40211082735, 
40211361387, 40212101411, 40219593463, 40211965084, 40211256217, 
40212270089, 40213116040, 40219593533, 40214320796, 40219593564, 
40219540169, 40214287089, 40219593575, 40219593457, 40211882841, 
40219593569, 40257957809, 40211392179, 40213545922, 40219593482, 
40219813712, 40219593601, 40211394107, 40213566445, 40216758948, 
40216483030, 40214072121, 40212420187, 40213545923, 40218946827, 
40212088013, 40212020662, 40211475864, 40219593449, 40216758951, 
40211458083, 40215035444, 40211766645, 40217625015, 40213985105, 
40212846683, 40213624142, 40212224962, 40219593505, 40215035442, 
40215035443, 40219593574, 40217932355, 40219593467, 40237099221, 
40237099219, 40210182296, 40211039283, 40211457549, 40212479098, 
40213349979, 40213469369, 40210869727, 40218907088, 40218907089, 
40218857434, 40218785946, 40210488142, 40210695071, 40210933499, 
40214140753, 40216398148, 40215035449, 40215035452, 40215035455, 
40215035456, 40215035457, 40215035458, 40215035451, 40215035454, 
40215035453, 40215035450, 40215035473, 40217828615, 40219113967, 
40219750497, 40218785947, 40210615103, 40210774814, 40210900713, 
40211164107, 40211358217, 40211540686, 40211821062, 40212439821, 
40213080793, 40213324947, 40213566416, 40213714078, 40217417707, 
40217417708, 40218833361, 40213469375, 40213469377, 40213469378, 
40213469376, 40213469374, 40219948307, 40248701061, 40219779762, 
40219779761, 40219779758, 40219779763, 40213469380, 40213469382, 
40213469383, 40213469381, 40213469379, 40213468109, 40215035470, 
40218051987, 40218769980, 40235844319, 40235844318, 40235844317, 
40237204852, 40218946771, 40219779747, 40216483027, 40213469372, 
40213469373, 40213469371, 40213469364, 40210898350, 40218872351, 
40219827363, 40235855000, 40256995391, 40219834962, 40235848300, 
40257014026, 40218857435, 40237222057, 40237222058, 40212479058, 
40213546005, 40217631464, 40210086909, 40210882302, 40211435912, 
40218785945, 40210074243, 40210330025, 40210441215, 40210615105, 
40210824607, 40211149392, 40213546011, 40215035476, 40217625009, 
40219113969, 40220014296, 40237165387, 40255170248, 40216534935, 
40218872362, 40219813676, 40234691828, 40255177468, 40210973371, 
40211710237, 40212479069, 40213546008, 40215035474, 40217828616, 
40219113970, 40220014295, 40214962663, 40217631535, 40219113965, 
40220014294, 40237155790, 40232244928, 40250801456, 40237103982, 
40255022043, 40214962664, 40237222099, 40237222098, 40237211031, 
40224209434, 40237211032, 40214253825, 40218510471, 40219487078, 
40236752476, 40229063846, 40213678146, 40217946313, 40214962658, 
40217946314, 40219926392, 40210441207, 40210537486, 40210774813, 
40210935269, 40211082112, 40211454375, 40211766627, 40211766635, 
40213116069, 40214308943, 40216622385, 40219048462, 40213847981, 
40218785948, 40218785949, 40218785950, 40218785951, 40218785952, 
40218785953, 40218785954, 40212973411, 40213116083, 40211710236, 
40220014298, 40237192436, 40257014030, 40211882845, 40212135229, 
40212479117, 40213185143, 40213546004, 40215035465, 40217625006, 
40219113966, 40210863205, 40211409624, 40212241916, 40213224557, 
40214287103, 40216622388, 40219113963, 40216735060, 40213080788, 
40213349982, 40213716935, 40214335926, 40215396230, 40216714025, 
40216735055, 40216735057, 40216735056, 40216735058, 40216735059, 
40211392283, 40211882856, 40212215172, 40219812765, 40233829254, 
40248714888, 40237155788, 40219757024, 40235848301, 40257014029, 
40218336916, 40219304409, 40229047557, 40248650295, 40216542007, 
40218847904, 40219126495, 40220014292, 40237155789, 40237192433, 
40215254539, 40216299855, 40232264147, 40219126494, 40220014297, 
40237192435, 40213349966, 40217085641, 40219368339, 40217905437, 
40213185155, 40214110492, 40216622400, 40218890231, 40219834983, 
40235855021, 40257632184, 2761688472, 40045583401, 40211392058, 
40211964416, 40211475943, 40211449552, 2761688354, 40210086766, 
40210097542, 2761688456, 40210074272, 40212643538, 40212643540, 
40211697159, 2761688983, 40049986148, 40212088008, 2761686049, 
40213225202, 40211430947, 40047706946, 40210248244, 40049820988, 
40046868717, 40046009896, 40211394045, 40047248945, 40046424460, 
40049785788, 2761690156, 40211430971, 2761688662, 2761687400, 
40212643536, 2761685897, 40210394553, 40210551702, 2761690222, 
40210665822, 40210641258, 40212088012, 40211533758, 40210248236, 
40213142830, 40211361523, 2761690577, 40049986147, 2761687820, 
40045673679, 40210248231, 40049760531, 40213225208, 2761686039, 
40211964410, 40045653550, 40211710321, 40046821365, 40211131603, 
40046304326, 2761686149, 40211798385, 40049986120, 40047734973, 
2761688066, 40049760532, 40210976590, 2761687894, 2761688406, 
40210974680, 40046866960, 40045673603, 40211754431, 40210086875, 
40211555142, 40047224870, 40047641602, 40046351398, 40210360042, 
40212643514, 40211710349, 40212183362, 2761688551, 40047702575, 
2761688012, 40211710354, 40211555150, 40047127730, 40045583395, 
40046744789, 2761689898, 40210641257, 2761688007, 2761688148, 
40211361302, 40210097564, 40213225231, 2761690695, 40212463292, 
40211458079, 2761688660, 2761688241, 2761687500, 40047127738, 
40210454129, 40049513593, 40211459626, 40210649342, 40211908931, 
40210086808, 2761686264, 2761690376, 40046304336, 40211697162, 
2761690396, 2761686551, 2761686583, 2761686574, 40211475944, 
2761686285, 40210568525, 40046821371, 2761687479, 40212168325, 
40047860799, 40210074595, 40210430322, 40210360037, 40046304323, 
40210713438, 2761688808, 2761686570, 40210430241, 40213150604, 
2761686447, 40211162299, 40047224869, 2761690692, 40047002662, 
2761690223, 40211710328, 40045251038, 40046868715, 40045597748, 
2761690282, 40211697160, 40211475949, 40211437189, 2761687492, 
2761686564, 40047795587, 40215312722, 40215312724, 40215312732, 
40215312734, 40215335934, 40215335935, 40215335937, 40215356291, 
40215356294, 40215356310, 40215356312, 40215356317, 40215445341, 
40215487276, 40215611551, 40216310834, 40216310836, 40216310841, 
40216483079, 40216483080, 40216601617, 40216601621, 40216714093, 
40216714095, 40216714097, 40216714098, 40216714099, 40216714100, 
40216714105, 40216714106, 40216714107, 40216714108, 40216715977, 
40216715978, 40216715979, 40216715980, 40216715981, 40216715983, 
40216715984, 40216715985, 40216752158, 40216752159, 40216752160, 
40216752163, 40216752164, 40216759049, 40216759051, 40216759052, 
40216759053, 40217591101, 40217591102, 40217591103, 40217591104, 
40217838557, 40217875731, 40217875734, 40217875735, 40217875736, 
40217875737, 40217905626, 40217932361, 40217932362, 40217932363, 
40218024834, 40218024893, 40218061462, 40218586184, 40218634760, 
40218634761, 40218634763, 40218634764, 40218705038, 40218705039, 
40218705158, 40218705174, 40218946787, 40218946788, 40219034113, 
40219034114, 40219054160, 40219089305, 40219114033, 40219114034, 
40219114035, 40219114036, 40219236511, 40219236512, 40219236513, 
40219236514, 40219236515, 40219255842, 40219346751, 40219593805, 
40219659142, 40219659143, 40219697158, 40219779823, 40219779824
);

select s.item_id
from store_item s, t_items t
where s.item_id = t.item_id
and store_id = 7100
and on_hand > 0
into temp t_dcinv;

delete from t_items
where item_id in (select item_id from t_dcinv);

select t.item_id
from t_dcinv d, t_items t
where d.item_id = t.item_id
into temp t_dc;

select n.*
from no_reord_period n, t_items t
where n.item_id = t.item_id
and edate < today+10
into temp t_updates
with no log;

delete from t_items
where item_id in (select item_id from t_updates);

select today-1 sdate, today+10 edate, t.item_id, 55 no_reord_id
from t_items t
into temp t_inserts
with no log;

begin work;

update no_reord_period
set edate = today+10
where no_reord_period.sdate||no_reord_period.item_id||
      no_reord_period.no_reord_id in (select sdate||item_id||no_reord_id from t_updates);
commit work;

begin work;

delete from no_reord_period
where item_id in (select item_id from t_dc);

commit work;

select first 163000 * from t_inserts
into temp t_inserts1 with no log;

delete from t_inserts
where item_id in (select item_id from t_inserts1);

select first 163000 * from t_inserts
into temp t_inserts2 with no log;

delete from t_inserts
where item_id in (select item_id from t_inserts2);

Begin work;

insert into no_reord_period
select sdate, edate, item_id, no_reord_id
from t_inserts;

commit work;

Begin work;

insert into no_reord_period
select sdate, edate, item_id, no_reord_id
from t_inserts1;

commit work;

Begin work;

insert into no_reord_period
select sdate, edate, item_id, no_reord_id
from t_inserts2;

commit work;
